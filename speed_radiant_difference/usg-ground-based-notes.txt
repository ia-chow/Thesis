LCs for all events are in May 2022 format, EXCEPT FOR:

- Almahatta Sitta
- Buzzard Coulee
- Kalabity
- Kosice

which are in the no-image format


notes after March 15 meeting:

plot speed and radiant difference vs. entry angle  
    colour-coded by duration, peak intensity, total energy (integrated intensity), height of peak brightness
    8 plots total


get luminous length, begin height, end height, duration/length above -12 and above -17 for all events
    references from B&B paper
    add to existing events csv files


Almahatta Sitta:

begin and end heights in fireball sheet corroborated by reference
no length from either
length imputed from existing data

Buzzard Coulee:

begin, end heights and length in fireball sheet
begin and end heights in reference match sheet, length not provided in reference

Chelyabinsk:

begin, end heights and length in fireball sheet

Kosice:

begin height in reference is different than fireball sheet (using reference here)
end heights match
no length
length imputed from existing data

Motopi Pan:

length provided by fireball sheet, not given in reference
begin height in reference is different than fireball sheet (using reference here)
end height not provided in fireball sheet but given in reference

Crawford Bay:

no info provided in fireball sheet
length provided in reference
begin, end height estimates provided in reference

Baird Bay:

no info provided in fireball sheet
length not in reference
begin height in reference
end height not estimated in reference due to technical limitations
imputed total length from fragmentation height + last estimated speed until final observation
extrapolated end height from fragmentation height and total length

Kalabity:

no info provided in fireball sheet
length not in reference
begin height in reference
end height in reference
length imputed from existing data

Romania:

no info provided in fireball sheet
begin, end height provided in reference
length not explicitly provided but inferred from Fig. 8 (~66? km)
length imputed from existing data

Flensburg:

begin and end height but not length provided in fireball sheet
begin height, end height, length all provided in reference; begin and end heights agree between fireball sheet and reference

Novo Mesto:

begin and end height but not length provided in both fireball sheet and reference
slight disagreement on begin and end height (using reference here)
length imputed from existing data

Saricicek:

length, begin height, end height all provided in fireball sheet
begin and end heights in the reference agree with fireball sheet, length not in reference

Vinales:

no data in sheet
begin, end height provided in reference, length not in reference
length imputed from existing data

Froslunda:

begin, end height provided in reference but not fireball sheet
length not provided (or maybe it is but I can't read norwegian)
length imputed from existing data

2022 EB5:

NASA JPL website (reference) doesn't have begin/end heights or length...
neither does sheet

no data

2019 MO:

NASA JPL website (reference) doesn't have begin/end heights or length...
neither does sheet

Use 62.2 degrees zenith angle, 16.45 km/s speed, 25 km height of peak brightness (from ground-based data)
GLM light curve has total estimated duration ~0 seconds-2.390 seconds (from 21:25:47.300 UTC - 21:25:49.597 UTC) and peak brightness occurs at ~1.64 seconds (at 21:25:48.939 UTC)
	Determine length of trail using light curve duration and seed (assuming constant speed)
	Determine begin and end heights using length of trail, zenith angle, and peak brightness height and time

begin height seems quite low...

Ozerski:

no data in either sheet or reference

Use 12.4 degrees zenith angle, 14.9 km/s speed, 27.2 km height of peak brightness (from paper)
Light curve has total duration from ~0 seconds-4.4 seconds and the peak brightness occurs at ~3.5 seconds
	Determine length of trail using light curve duration and speed (assuming constant speed)
	Determine begin and end heights using length of trail, zenith angle, and peak brightness height and time


Recomputing radiants for several events assuming sign typos in CNEOS data (as in https://iopscience.iop.org/article/10.3847/1538-3881/ac75d2/pdf for TC3/AS) to see if usg, ground-based match up better afterwards:

2008 TC3/Almahatta Sitta (2008-10-07 02:45:45 UT):

flipping [-9, 9, 3.8] km/s to [-9, 9, -3.8] km/s gives a radiant azimuth/zenith angle that produces radiant diff that almost exactly matches the ground-based observations, as noted

Buzzard Coulee (2008-11-21 00:26:44 UT):

flipping [3.9, -4.1, -11.6] km/s to [3.9, 4.1, -11.6] km/s gives a radiant azimuth/zenith angle within 11 degrees of ground-based... probably not enough?
aside from that nothing...

Kosice (2010-02-28 22:24:50 UT):

nothing...

Crawford Bay (2017-09-05 05:11:27 UT):

nothing...

Saricicek (2015-09-02 20:10:30 UT) (typo in the date in B&B):

nothing...

Re-generated all the speed/radiant diff vs. various parameters plots with the recomputed radiant difference for AS, no obviously noticeable change in the trend...


Added Queensland event (done, although I can't use it in the analysis yet because it doesn't have a LC) 
Created speed/radiant diff vs. date plots
Plotted CDFs/histograms of radiant/speed difference across domain


Dimensionality reduction (preliminary done):

10 parameters used in pca and umap: speed, height of max brightness, date, begin height, end height, length, peak intensity, duration, total energy, entry angle
16 data points: everything except qld (no LC) and eb5 (no length or begin/end height)
    could redo the pca and umap/tsne removing some of these parameters so we could use qld or eb5?

PCA doesn't show anything obvious...
UMAP identifiies (tentatively) one unique group of 3 (Kalabity, Baird Bay, Froslunda) but could just be luck...


Monte Carlo Granvik Model:

Draw smooth KDE to sample from using nonparametric distribution with a Gaussian kernel
Read in decameter events
Estimated speed uncertainty for 100 Monte Carlo samples for each decameter event by drawing from the KDE
    Ran the state vectors for all the Monte Carlo samples for each event through the WMPL code to convert the state vectors to orbital parameters, and then saved the orbital parameters to a .npy file
    Checked SMA of MC samples againt the true values to see if it was working as expected
        checks out!
    

Things TODO for Granvik model probabilistic association of events with escape regions.

1. Figure out how to implement radiant uncertainty since the radiant difference is dependent on both the altitude and azimuth, to see how it breaks down into individual uncertainties for altitude and azimuth
    - Remember the KDE is drawn over the distribution of the log-radiant
    - Talk to Peter about this
2. Figure out why WMPL sometimes doesn't return the orbital parameters when certain state vectors are input
    - Also talk to Peter/Denis about this
3. Figure out how to compute absolute magnitude H for each decameter event since the Granvik model is a 4-D distribution using a, e, i, H
    - a, e, i returned by WMPL but it doesn't seem like H is?
4. Granvik model only has discrete samples of the 4-D distribution in a multidimensional grid, so we use lerp to interpolate the distribution for the whole parameter space
    - Cubic spline is preferred but no libraries for 4-D cubic spline interpolation in python -- generally seems like a very hard problem
- Remember that Granvik model file needs to be gotten from the dropbox if I want to use locally


Granvik model.dat file has a typo -- single value of Hmag = 15.605 instead of 15.625